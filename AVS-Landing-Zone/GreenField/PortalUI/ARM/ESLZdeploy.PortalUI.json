{
    "$schema": "<relative path to createFormUI.schema.json>",
    "view": {
        "kind": "Form",
        "properties": {
            "title": "AVS Landing Zone Accelerator",
            "steps": [
                {
                    "name": "basics",
                    "label": "Azure core setup",
                    "subLabel": {
                        "preValidation": "Provide deployment prefix for the resource groups and resources that will be created.",
                        "postValidation": "Done"
                    },
                    "bladeTitle": "avsBasics",
                    "elements": [
                        {
                            "name": "avsDeploymentScope",
                            "type": "Microsoft.Common.ResourceScope",
                            "location": {
                                "resourceTypes": []
                            }
                        },
                        {
                            "name": "avsSharedServices",
                            "type": "Microsoft.Common.InfoBox",
                            "options": {
                                "text": "The subscription and location (Region) selected in this step will be used to deploy the AVS Landing Zone resources (Private Cloud, Virtual Networks, VMs etc.)",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "rbacInfo",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "Azure VMware Solution (AVS) AVS Landing Zone deployment requires contributor access at the subscription scope. Visit this link to get more information on RBAC permissions and scopes.",
                                "uri": "https://docs.microsoft.com/en-us/azure/role-based-access-control/scope-overview",
                                "style": "Warning"
                            }
                        }
                    ]
                },
                {
                    "name": "PrivateCloud",
                    "label": "Private Cloud",
                    "elements": [
                        {
                            "name": "avsInfo",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Prerequisites",
                            "elements": [
                                {
                                    "name": "avsPrerequisites2",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "Before you start, you must request AVS quota allocation for your subscription",
                                        "link": {
                                            "label": "",
                                            "uri": ""
                                        }
                                    }
                                },
                                {
                                    "name": "avsPrerequisites3",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "- If you are Enterprise agreement (EA) customer, you need to log a support request to allocate hosts",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://docs.microsoft.com/en-us/azure/azure-vmware/request-host-quota-azure-vmware-solution?WT.mc_id=Portal-VMCP#request-host-quota-for-ea-customers"
                                        }
                                    }
                                },
                                {
                                    "name": "avsPrerequisites4",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "- If you are a CSP customer, use Microsoft Partner Center to make this available for your customers",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://docs.microsoft.com/en-us/azure/azure-vmware/request-host-quota-azure-vmware-solution?WT.mc_id=Portal-VMCP#request-host-quota-for-csp-customers"
                                        }
                                    }
                                },
                                {
                                    "name": "avsPrerequisites5",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "- Get a valid non-overlapping CIDR address block. Azure VMware Solution ingests a /22 network that you provide and then carves it up into smaller segments and then uses those IP segments for vCenter, VMware HCX, NSX-T, and vMotion.",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://docs.microsoft.com/azure/azure-vmware/tutorial-network-checklist?WT.mc_id=Portal-VMCP"
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "name": "DeployPrivateCloud",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Deploy a new or choose an existing Private Cloud",
                            "defaultValue": "Yes",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "New",
                                        "value": true
                                    },
                                    {
                                        "label": "Existing",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "avsPrivateCloudSettings",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('PrivateCloud').DeployPrivateCloud, true)]",
                            "label": "Private Cloud details",
                            "elements": [
                                {
                                    "name": "avsAddressSpace",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": true,
                                    "label": "AVS Address Space",
                                    "defaultValue": "",
                                    "toolTip": "This CIDR represents the Private Cloud Management network and will be used for the cluster management services (i.e vCenter Server, NSX-T Manager, etc.). Please use /22 address space. The address should be unique and should not overlap with other Azure Virtual Networks (VNET) as well as with on-premises networks.",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})(/[2][2])$",
                                        "validationMessage": "Address space must be /22"
                                    }
                                },
                                {
                                    "name": "avsSkuType",
                                    "type": "Microsoft.Common.DropDown",
                                    "visible": true,
                                    "label": "AVS SKU",
                                    "defaultValue": "AV36",
                                    "multiLine": true,
                                    "toolTip": "Ensure you select the correct SKU as per your quota request",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "AV36",
                                                "description": "",
                                                "value": "AV36"
                                            },
                                            {
                                                "label": "AV36T (Trial SKU)",
                                                "description": "",
                                                "value": "AV36T"
                                            },
                                            {
                                                "label": "AV36P",
                                                "description": "",
                                                "value": "AV36P"
                                            },
                                            {
                                                "label": "AV36PT (Trial SKU)",
                                                "description": "",
                                                "value": "AV36PT"
                                            },
                                            {
                                                "label": "AV52",
                                                "description": "",
                                                "value": "AV52"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "avsHostCount",
                                    "type": "Microsoft.Common.Slider",
                                    "label": "AVS Host Count",
                                    "subLabel": "",
                                    "toolTip": "This is the number of ESXi hosts that will make up the default cluster of your private cloud, minimum is 3",
                                    "min": 3,
                                    "max": 16,
                                    "defaultValue": 3,
                                    "showStepMarkers": true,
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "avsQuotaInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": true,
                                    "options": {
                                        "text": "Ensure that you have already requested quota for your chosen SKU above, and that this has already been allocated to this subscription otherwise the deployment will fail.",
                                        "uri": "https://learn.microsoft.com/en-us/azure/azure-vmware/request-host-quota-azure-vmware-solution",
                                        "style": "Warning"
                                    }
                                }                                
                            ]
                        },
                        {
                            "name": "existingAVSPrivateCloudSettings",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('PrivateCloud').DeployPrivateCloud, false)]",
                            "label": "Existing Private Cloud details",
                            "elements": [
                                {
                                    "name": "existingAVSSelector",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "visible": "",
                                    "label": "Select the Existing AVS Private Cloud",
                                    "resourceType": "Microsoft.AVS/privateClouds",
                                    "options": {
                                        "filter": {
                                            "subscription": "onBasics",
                                            "location": "onBasics"
                                        }
                                    },
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "existingavsInfo",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "",
                                    "options": {
                                        "text": "The Private Cloud chosen in this step will be used for all the following modules",
                                        "style": "Info"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "azureNetwork",
                    "label": "Azure Connectivity",
                    "bladeTitle": "azureNetworkingSettings",
                    "elements": [
                        {
                            "name": "avsInfo",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "AVS Connectivity",
                            "elements": [
                                {
                                    "name": "networkinfo1",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "AVS is deployed by design in an isolated manner and has no connectivity to either Azure or any other network. In order to connect AVS to Azure, a connection must be made from AVS to Azure via an ExpressRoute Gateway.",
                                        "link": {
                                            "label": "",
                                            "uri": ""
                                        }
                                    }
                                },
                                {
                                    "name": "networkinfo2",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "This deployment will allow you to select a new or existing Virtual Network, input the subnets required and deploy the ExpressRoute Gateway if one does not already exist. If you select Yes to connect AVS to Azure, then at the end of this deployment, a connection will automatically be created from the gateway to your AVS Private Cloud, allowing Azure Resources in the selected vNet to communicate with AVS. See link below for more information.",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://docs.microsoft.com/en-us/azure/azure-vmware/tutorial-configure-networking"
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "name": "DeployNetworking",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Connect AVS to an Azure VNet",
                            "defaultValue": "No (Skip)",
                            "toolTip": "Select Yes to continue with this step, or No to Skip",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {   
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No (Skip)",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "VNetExists",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": "[equals(steps('azureNetwork').DeployNetworking, true)]",
                            "label": "Virtual Network",
                            "defaultValue": "None",
                            "toolTip": "Select New to deploy a new virtual network, or choose an existing VNet",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {   
                                        "label": "New",
                                        "value": false
                                    },
                                    {
                                        "label": "Existing",
                                        "value": true
                                    }
                                ]
                            }
                        },
                        {
                            "name": "vNetAddressSpace",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('azureNetwork').VNetExists, false)]",
                            "label": "Virtual Network address range",
                            "toolTip": "Virtual network in Azure Native to host the ExpressRoute Gateway, Jumpbox and Bastion for AVS Connectivity. Ensure this is not overlapping the AVS Private Cloud",
                            "defaultValue": "",
                            "placeholder": "Example: 192.168.0.0/22",
                            "constraints": {
                                "required": true,
                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                "validationMessage": "Invalid CIDR range. The address prefix must be in the range 10 to 24."
                            }
                        },
                        {
                            "name": "GatewaySubnet",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('azureNetwork').VNetExists, false)]",
                            "label": "Gateway Subnet Prefix",
                            "toolTip": "Enter the address prefix for the new GatewaySubnet",
                            "defaultValue": "",
                            "placeholder": "Example: 192.168.0.0/27",
                            "constraints": {
                                "required": true,
                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-9]))$",
                                "validationMessage": "Invalid CIDR range. The address prefix must be in the range 20 to 29."
                            }
                        },
                        {
                            "name": "VnetSelectorId",
                            "type": "Microsoft.Solutions.ResourceSelector",
                            "visible": "[equals(steps('azureNetwork').VNetExists, true)]",
                            "label": "Virtual Network",
                            "resourceType": "Microsoft.Network/virtualNetworks",
                            "constraints": {
                                "required": true
                            }
                        },
                        {
                            "name": "virtualNetworkGatewaysApi",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "[concat(steps('basics').avsDeploymentScope.subscription.id, '/providers/Microsoft.Network/virtualNetworkGateways?api-version=2022-11-01')]"
                            }
                        },
                        {
                            "name": "virtualNetworkGateway",
                            "type": "Microsoft.Common.DropDown",
                            "visible": "[equals(steps('azureNetwork').VNetExists, true)]",
                            "label": "Select Existing ExpressRoute Gateway",
                            "defaultValue": "",
                            "toolTip": "",
                            "constraints": {
                                "allowedValues": "[map(filter(steps('azureNetwork').virtualNetworkGatewaysApi.value, (item) => contains(first(item.properties.ipConfigurations).properties.subnet.id, steps('azureNetwork').VnetSelectorId.name)), (item) => parse(concat('{\"label\":\"', item.name, '\",\"value\":\"', item.name, '\"}')))]"
                            }
                        },
                        {
                            "name": "GWSubnetExistsFalse",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('azureNetwork').VNetExists, true)]",
                            "options": {
                                "text": "An ExpressRoute Gateway is required to connect your virtual network to AVS. If one does not exist, select Skip. You can come back and repeat this step once the ExpressRoute Gateway has been deployed.",
                                "style": "Warning"
                            }
                        },                    
                        {
                            "name": "jumpboxinfo",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('azureNetwork').VNetExists, false)]",
                            "label": "Jumpbox and Bastion (Optional)",
                            "elements": [
                                {
                                    "name": "jumpboxinfo1",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "Once AVS connectivity to Azure Native has been established, you will want to connect to vCenter. Choose the options below to deploy a Jumpbox and Azure Bastion into the new virtual network specified above, or skip if one already exists.",
                                        "link": {
                                            "label": "",
                                            "uri": ""
                                        }
                                    }
                                },
                                {
                                    "name": "jumpboxinfo2",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "You will need to specify the subnets for these resources to be deployed into. Ensure these are from the same address space as the new virtual network.",
                                        "link": {
                                            "label": "",
                                            "uri": ""
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "name": "createJumpbox",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": "[equals(steps('azureNetwork').VNetExists, false)]",
                            "label": "Deploy Jumpbox and Azure Bastion",
                            "defaultValue": "No",
                            "toolTip": "Deploy a Jumpbox and Azure Bastion",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "BastionSubnet",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('azureNetwork').createJumpbox, true)]",
                            "label": "Azure Bastion Subnet Prefix",
                            "toolTip": "The Bastion host is deployed in the virtual network that contains the AzureBastionSubnet subnet that has a minimum /26 prefix.",
                            "defaultValue": "",
                            "placeholder": "Example: 192.168.1.0/24",
                            "constraints": {
                                "required": true,
                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-4]|2[0-6]))$",
                                "validationMessage": "Invalid CIDR range. The address prefix must be in the range 24 to 26."
                            }
                        },
                        {
                            "name": "JumpboxSubnet",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('azureNetwork').createJumpbox, true)]",
                            "label": "Jumpbox Subnet Prefix",
                            "toolTip": "New Subnet for the Jumpbox",
                            "defaultValue": "",
                            "placeholder": "Example: 192.168.2.0/24",
                            "constraints": {
                                "required": true,
                                "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-8]))$",
                                "validationMessage": "Invalid CIDR range. The address prefix must be in the range 10 to 28."
                            }
                        },
                        {
                            "name": "vmSkuSelector",
                            "type": "Microsoft.Compute.SizeSelector",
                            "visible": "[equals(steps('azureNetwork').createJumpbox, true)]",
                            "label": "Jumpbox SKU",
                            "toolTip": "Select a VM SKU for the Jumpbox",
                            "defaultValue": "Standard_B2ms",
                            "recommendedSizes": [
                                "Standard_D1",
                                "Standard_D2",
                                "Standard_D3"
                            ],
                            "constraints": {
                                "allowedSizes": [],
                                "excludedSizes": [],
                                "required": true
                            },
                            "options": {
                                "hideDiskTypeFilter": true
                            },
                            "osPlatform": "Windows",
                            "imageReference": {
                                "publisher": "MicrosoftWindowsDesktop",
                                "offer": "Windows-11",
                                "sku": "21h2-avd"
                            }
                        },
                        {
                            "name": "operatingSystemSKU",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Jumpbox Operating System",
                            "placeholder": "",
                            "defaultValue": ["Windows Server 2022"],
                            "toolTip": "Choose the operating system for the Jumpbox",
                            "multiselect": false,
                            "selectAll": true,
                            "filter": true,
                            "filterPlaceholder": "Filter items ...",
                            "multiLine": true,
                            "defaultDescription": "Jumpbox Operating System",
                            "constraints": {
                              "allowedValues": [
                                {
                                    "label": "Windows Server 2022",
                                    "description": "Windows Server 2022",
                                    "value": "Win2022"
                                },
                                {
                                  "label": "Windows Server 2019",
                                  "description": "Windows Server 2019",
                                  "value": "Win2019"
                                },
                                {
                                    "label": "Windows 11",
                                    "description": "Windows 11",
                                    "value": "Win11"
                                },
                                {
                                    "label": "Windows 11 Multisession",
                                    "description": "Windows 11 Multisession",
                                    "value": "Win11ms"
                                },
                                {
                                    "label": "Ubuntu 20.04",
                                    "description": "Ubuntu 20.04",
                                    "value": "ubuntu2004gen2"
                                }
                              ],
                              "required": true
                            },
                            "visible": "[equals(steps('azureNetwork').createJumpbox, true)]"
                        },
                        {
                            "name": "BootstrapJumpboxVM",
                            "type": "Microsoft.Common.CheckBox",
                            "label": "BootStrap VM",
                            "toolTip": "Bootstrap VM and install PowerCLI, VMRC, Powershell. This will only work for Windows based VMs, not Linux",
                            "visible": "[equals(steps('azureNetwork').createJumpbox, true)]"
                        },
                        {
                            "name": "jumpboxCredentials",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('azureNetwork').createJumpbox, true)]",
                            "label": "Jumpbox login credentials",
                            "elements": [
                                {
                                    "name": "jumpboxLocalUserName",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Username",
                                    "toolTip": "Provide username for the Jumpbox local admin account.",
                                    "placeholder": "Example: avsadmin",
                                    "defaultValue": "",
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "JumpboxPassword",
                                    "type": "Microsoft.Compute.CredentialsCombo",
                                    "visible": true,
                                    "label": {
                                        "password": "Password",
                                        "confirmPassword": "Confirm password"
                                    },
                                    "toolTip": {
                                        "password": "The password must be alphanumeric, contain at least 8 characters, have at least 1 letter, 1 number and 1 special character."
                                    },
                                    "constraints": {
                                        "required": true,
                                        "customPasswordRegex": "^(?=.*[0-9])(?=.*[a-z])(?=.*[@#$%^&+=_!*<>()])(?=\\S+$).{12,123}$",
                                        "customValidationMessage": "Password must include at least 8 characters, have at least 1 letter, 1 number and 1 special character."
                                    },
                                    "options": {
                                        "hideConfirmation": false
                                    },
                                    "osPlatform": "Windows"
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "Monitoring",
                    "label": "Monitoring",
                    "elements": [
                        {
                            "name": "AVSBaseAlerts",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "AVS Monitoring and Alerts",
                            "elements": [
                                {
                                    "name": "AVSAlertInfo1",
                                    "type": "Microsoft.Common.TextBlock",
                                    "label": "AVS Monitoring and Alerts",
                                    "options": {
                                        "text": "Monitoring is a crucial aspect to any service and ensures that teams are alerted for any failures, maintenance events, performance degradation etc. As part of this deployment, you will have the option to deploy an Azure Dashboard to visualize metrics from your Private Cloud, deploy some Azure Monitor Metric alerts and also setup some Azure Service Health Alerts for AVS",
                                        "link": {
                                            "label": "",
                                            "uri": ""
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "name": "DeployMonitoring",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Deploy Monitoring Module",
                            "toolTip": "Deploy or Skip this Monitoring Module",
                            "defaultValue": "No (Skip)",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No (Skip)",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "AVSWorkbook",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                            "label": "AVS Workbook",
                            "elements": [
                                {
                                    "name": "WorkbookInfo1",
                                    "type": "Microsoft.Common.TextBlock",
                                    "label": "AVS Workbook",
                                    "options": {
                                        "text": "Workbooks provide a flexible canvas for data analysis and the creation of rich visual reports within the Azure portal. We have created an AVS specific Workbook which will show you all the information you need to monitor and view all your AVS Private Clouds. This Workbook includes a Dasbboard, Alerts, Syslog, Virtual Machines, Usage and Quota information. For more details of this workbook, click the link below",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://github.com/Azure/Enterprise-Scale-for-AVS/tree/main/BrownField/Monitoring/AVS-Workbook"
                                        }
                                    }
                                },
                                {
                                    "name": "DeployAVSWorkbook",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "",
                                    "label": "Deploy an Azure Workbook for AVS",
                                    "toolTip": "Deploy an AVS Workbook that provides a Dashboard, Logging, Monitoring, Quota etc",
                                    "defaultValue": "No",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "WorkbookInfo2",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('Monitoring').AVSWorkbook.DeployAVSWorkbook, true)]",
                                    "options": {
                                        "icon": "None",
                                        "text": "Some elements of the Workbook require logging to be enabled for the Subscription and Private Cloud. Head over to the Logging tab in the next screen to turn this on, or perform this task manually after this deployment",
                                        "style": "Info"
                                    }
                                }
                            ]
                        },
                        {
                            "name": "AVSDashboard",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                            "label": "AVS Dashboard and Alerts",
                            "elements": [
                                {
                                    "name": "DashboardInfo1",
                                    "type": "Microsoft.Common.TextBlock",
                                    "label": "AVS Dashboard",
                                    "options": {
                                        "text": "In addition to the workbook above, we have provided the ability to also deploy a dedicated Azure dashboard for your Private Cloud. Also, optionally select to enable AVS Service Health alerts and Metric alerts to be sent to an email address",
                                        "link": {
                                            "label": "",
                                            "uri": ""
                                        }
                                    }
                                },
                                {
                                    "name": "DeployDashboard",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "",
                                    "label": "Deploy an Azure Dashboard for AVS",
                                    "toolTip": "Deploy a dedicated AVS Dashboard for the Private Cloud selected",
                                    "defaultValue": "No",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "DeployServiceHealth",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                                    "label": "Enable Service Health alerts for AVS",
                                    "defaultValue": "No",
                                    "toolTip": "Enable Service Health alerts for AVS on this subscription",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "DeployAVSAlerts",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "",
                                    "label": "Enable Azure Monitor alerts for AVS",
                                    "toolTip": "Enable AVS Metric alerts for your Private Cloud, use the sliders below to define your alert thresholds",
                                    "defaultValue": "No",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "MonitoringInputs",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('Monitoring').DeployMonitoring, true)]",
                            "label": "",
                            "elements": [
                                {
                                    "name": "ActionGroupEmails",
                                    "type": "Microsoft.Common.TextBox",
                                    "label": "Email address to send the alerts to",
                                    "visible": "[or(equals(steps('Monitoring').AVSDashboard.DeployAVSAlerts, true), equals(steps('Monitoring').AVSDashboard.DeployServiceHealth, true))]",
                                    "toolTip": "Provide an email address to send the service health alerts to",
                                    "placeholder": "Example: alerts@contoso.com",
                                    "defaultValue": "",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$",
                                        "validationMessage": "Please provide a valid email address"
                                    }
                                },
                                {
                                    "name": "MetricAlertInfo1",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('Monitoring').AVSDashboard.DeployAVSAlerts, true)]",
                                    "options": {
                                        "icon": "None",
                                        "text": "The default values below are set as a reference only, use the sliders to adjust as required",
                                        "style": "Info"
                                    }
                                },
                                {
                                    "name": "cpuUsageThreshold",
                                    "type": "Microsoft.Common.Slider",
                                    "visible": "[equals(steps('Monitoring').AVSDashboard.DeployAVSAlerts, true)]",
                                    "label": "CPU Usage % per Cluster (Sev 2 Alert)",
                                    "subLabel": "",
                                    "toolTip": "Set the CPU Usage Threshold to be alerted on per Cluster",
                                    "min": 1,
                                    "max": 100,
                                    "defaultValue": 60,
                                    "showStepMarkers": true,
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "memoryUsageThreshold",
                                    "type": "Microsoft.Common.Slider",
                                    "visible": "[equals(steps('Monitoring').AVSDashboard.DeployAVSAlerts, true)]",
                                    "label": "Memory Usage % Threshold (Sev 2 Alert)",
                                    "subLabel": "",
                                    "toolTip": "Set the Memory Usage Threshold to be alerted on per Cluster",
                                    "min": 1,
                                    "max": 100,
                                    "defaultValue": 60,
                                    "showStepMarkers": true,
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "storageUsageThreshold",
                                    "type": "Microsoft.Common.Slider",
                                    "visible": "[equals(steps('Monitoring').AVSDashboard.DeployAVSAlerts, true)]",
                                    "label": "Storage Usage % Threshold (Sev 2 Alert)",
                                    "subLabel": "",
                                    "toolTip": "Set the Storage Usage Threshold to be alerted on per Cluster",
                                    "min": 1,
                                    "max": 100,
                                    "defaultValue": 60,
                                    "showStepMarkers": true,
                                    "constraints": {
                                        "required": true
                                    }
                                },
                                {
                                    "name": "MonitoringInputsInfo1",
                                    "type": "Microsoft.Common.InfoBox",
                                    "visible": "[equals(steps('Monitoring').AVSDashboard.DeployAVSAlerts, true)]",
                                    "options": {
                                        "icon": "None",
                                        "text": "In addition to the alerts above, we will create Sev 0 alerts based on VMware recommended thresholds. These will be set as 80% for CPU and Memory, 75% for Storage",
                                        "style": "Info"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "Diagnostics",
                    "label": "Logging",
                    "elements": [
                        {
                            "name": "DiagnosticInfo1",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "AVS Diagnostic Settings",
                            "elements": [
                                {
                                    "name": "AVSAlertInfo1",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "Diagnostic settings in Azure allow for the collection of resource and activity logs to either be stored to a storage account, to a Log Analytics Workspace or streamed to an Event Hub. This provides the ability to store and retrieve logs for future diagnosis or troubleshooting. In this deployment, you will select the Private Cloud you would like to enable Diagnostic Settings, and send these to a New or Existing Log Analytics Workspace or Storage Account",
                                        "link": {
                                            "label": "Learn more",
                                            "uri": "https://learn.microsoft.com/en-us/azure/azure-vmware/configure-vmware-syslogs"
                                        }        
                                    }
                                }
                            ]
                        },
                        {
                            "name": "DeployDiagnostics",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": "",
                            "label": "Deploy Diagnostic Settings",
                            "toolTip": "Deploy Diagnostic Settings",
                            "defaultValue": "No (Skip)",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No (Skip)",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "DiagnosticInfo2",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('Diagnostics').DeployDiagnostics, true)]",
                            "options": {
                                "text": "Collecting logs and enabling diagnostic settings may incur additional charges such as storage, ingestion and retention. Click here for more information",
                                "uri": "https://learn.microsoft.com/en-us/azure/azure-monitor/usage-estimated-costs",
                                "style": "Warning"
                            }
                        },
                        {
                            "name": "Workspace",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('Diagnostics').DeployDiagnostics, true)]",
                            "label": "Log Analytics Workspace Settings",
                            "elements": [
                                {
                                    "name": "AVSLogCollection",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('Diagnostics').DeployDiagnostics, true)]",
                                    "label": "Send AVS Logs to a Log Analytics Workspace",
                                    "toolTip": "Send AVS Logs to a Log Analytics Workspace",
                                    "defaultValue": "No",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "ActivityLogCollection",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('Diagnostics').DeployDiagnostics, true)]",
                                    "label": "Send Subscription Activity Logs to a Log Analytics Workspace",
                                    "toolTip": "Send Subscription Activity Logs to a Log Analytics Workspace",
                                    "defaultValue": "No",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "DeployWorkspace",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[or(equals(steps('Diagnostics').Workspace.AVSLogCollection, true), equals(steps('Diagnostics').Workspace.ActivityLogCollection, true))]",
                                    "label": "Deploy New or Choose Existing Workspace",
                                    "toolTip": "Deploy New or Choose Existing Workspace",
                                    "defaultValue": "New",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "New",
                                                "value": true
                                            },
                                            {
                                                "label": "Existing",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "existingWorkspaceSelector",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "visible": "[equals(steps('Diagnostics').Workspace.DeployWorkspace, false)]",
                                    "label": "Select the Existing Log Analytics Workspace",
                                    "resourceType": "Microsoft.OperationalInsights/workspaces"
                                }
                            ]
                        },
                        {
                            "name": "StorageAccount",
                            "type": "Microsoft.Common.Section",
                            "visible": "[equals(steps('Diagnostics').DeployDiagnostics, true)]",
                            "label": "Storage Account Settings",
                            "elements": [
                                {
                                    "name": "StorageLogCollection",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('Diagnostics').DeployDiagnostics, true)]",
                                    "label": "Send AVS Logs to a storage account",
                                    "toolTip": "Send AVS Logs to a storage account",
                                    "defaultValue": "No",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "Yes",
                                                "value": true
                                            },
                                            {
                                                "label": "No",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "DeployStorageAccount",
                                    "type": "Microsoft.Common.OptionsGroup",
                                    "visible": "[equals(steps('Diagnostics').StorageAccount.StorageLogCollection, true)]",
                                    "label": "Deploy New or Choose Existing Storage Account",
                                    "toolTip": "Deploy New or Choose Existing Storage Account",
                                    "defaultValue": "New",
                                    "constraints": {
                                        "required": true,
                                        "allowedValues": [
                                            {
                                                "label": "New",
                                                "value": true
                                            },
                                            {
                                                "label": "Existing",
                                                "value": false
                                            }
                                        ]
                                    }
                                },
                                {
                                    "name": "existingStorageAccountSelector",
                                    "type": "Microsoft.Solutions.ResourceSelector",
                                    "visible": "[equals(steps('Diagnostics').StorageAccount.DeployStorageAccount, false)]",
                                    "label": "Select the Existing Storage Account",
                                    "resourceType": "Microsoft.Storage/storageAccounts"
                                },
                                {
                                    "name": "storageRetention",
                                    "type": "Microsoft.Common.Slider",
                                    "visible": "[equals(steps('Diagnostics').StorageAccount.StorageLogCollection, true)]",
                                    "label": "Storage Account Retention Days",
                                    "subLabel": "",
                                    "toolTip": "Retention only applies to storage account. Retention policy ranges from 1 to 365 days. If you do not want to apply any retention policy and retain data forever, set retention (days) to 0.",
                                    "min": 0,
                                    "max": 365,
                                    "defaultValue": 1,
                                    "showStepMarkers": true,
                                    "constraints": {
                                        "required": true
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "Addons",
                    "label": "Addons",
                    "elements": [
                        {
                            "name": "AVSBaseAlerts",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "AVS Addons",
                            "elements": [
                                {
                                    "name": "AddonsInfo1",
                                    "type": "Microsoft.Common.TextBlock",
                                    "options": {
                                        "text": "In addition to the Private Cloud deployment, you may choose to install optional addons such as HCX and SRM. Please select the ones you need from the options below",
                                        "link": {
                                            "label": "",
                                            "uri": ""
                                        }        
                                    }
                                }
                            ]
                        },
                        {
                            "name": "deployHCX",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Deploy HCX",
                            "defaultValue": "No",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "deploySRM",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Deploy SRM",
                            "defaultValue": "No",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "srmInfo",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": "[equals(steps('Addons').deploySRM, true)]",
                            "options": {
                                "text": "Placeholder for SRM info.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/en-us/azure/azure-vmware/disaster-recovery-using-vmware-site-recovery-manager#install-srm-in-azure-vmware-solution"
                                }
                            }
                        },
                        {
                            "name": "srmLicenseKey",
                            "type": "Microsoft.Common.TextBox",
                            "visible": "[equals(steps('Addons').deploySRM, true)]",
                            "label": "License Key",
                            "toolTip": "The license key is required to install SRM.",
                            "placeholder": "Enter your license key",
                            "defaultValue": "",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-zA-Z0-9]{5}-[a-zA-Z0-9]{5}-[a-zA-Z0-9]{5}-[a-zA-Z0-9]{5}-[a-zA-Z0-9]{5}$",
                                "validationMessage": "Invalid license key, the license must be formatted as 5 groups of 5 alphanumeric characters, separated by hyphens."
                            }
                        },
                        {
                            "name": "srmVRCount",
                            "type": "Microsoft.Common.Slider",
                            "visible": "[equals(steps('Addons').deploySRM, true)]",
                            "label": "Number of Replication Servers",
                            "subLabel": "",
                            "toolTip": "Number of vSphere replication servers to be deployed, minimum 1",
                            "min": 1,
                            "max": 3,
                            "defaultValue": 1,
                            "showStepMarkers": true,
                            "constraints": {
                                "required": true
                            }
                        }
                    ]
                },
                {
                    "name": "ResourceNaming",
                    "label": "Resource Naming",
                    "elements": [
                        {
                            "name": "namingInfo",
                            "type": "Microsoft.Common.Section",
                            "visible": true,
                            "label": "Resource Naming",
                            "elements": [
                                {
                                    "name": "avsResourceNamingInfo1",
                                    "type": "Microsoft.Common.TextBlock",
                                    "visible": true,
                                    "options": {
                                        "text": "The AVS accelerator uses the Prefix below to provide automated resource naming based on Microsoft best practices. To set specific names for certain resources as per your own naming standards, select Yes to Custom Naming below. Note, custom naming fields will appear based on selections in other tabs",
                                        "link": {
                                            "label": "",
                                            "uri": ""
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "name": "avsDeploymentPrefix",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Naming prefix",
                            "visible": true,
                            "toolTip": "Provide a prefix (max 8 characters) for the resource groups and resources created as part of AVS landing zones.",
                            "defaultValue": "",
                            "placeholder": "Example: AVS",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z-]{1,8}$",
                                "validationMessage": "The prefix must be 1-8 characters."
                            }
                        },
                        {
                            "name": "CustomNaming",
                            "type": "Microsoft.Common.OptionsGroup",
                            "visible": true,
                            "label": "Custom Naming",
                            "defaultValue": "No",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": true
                                    },
                                    {
                                        "label": "No",
                                        "value": false
                                    }
                                ]
                            }
                        },
                        {
                            "name": "customnamingInfo1",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": true,
                            "options": {
                                "text": "Click here to see the resource group and resource names that will be created with the Prefix above. This Prefix is still required even when custom naming is selected as it will be used for the deployment tasks and for naming other resources",
                                "uri": "https://raw.githubusercontent.com/shaunjacob/Enterprise-Scale-for-AVS-Fork/RemoveOnPremGreenfield/docs/images/AVSLZ-CustomNaming.png",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "customnamingInfo2",
                            "type": "Microsoft.Common.InfoBox",
                            "visible": "[equals(steps('ResourceNaming').CustomNaming, true)]",
                            "options": {
                                "text": "Entering an existing resource group name will not have any impact to any other resources in the resource group",
                                "style": "Info"
                            }
                        },
                        {
                            "name": "PrivateCloudNaming",
                            "type": "Microsoft.Common.Section",
                            "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('PrivateCloud').DeployPrivateCloud, true))]",
                            "label": "Private Cloud Naming",
                            "elements": [
                                {
                                    "name": "AVSResourceGroup",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('PrivateCloud').DeployPrivateCloud, true))]",
                                    "label": "AVS Resource Group Name",
                                    "defaultValue": "",
                                    "placeholder": "Example: Prefix-PrivateCloud",
                                    "toolTip": "Name of a resource group to host the AVS Resources. This can also be an existing resource group name",
                                    "constraints": {
                                        "required": true,
                                        "regex": "",
                                        "validationMessage": "Provide a name for your Resource Group"
                                    }
                                },
                                {
                                    "name": "AVSName",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('PrivateCloud').DeployPrivateCloud, true))]",
                                    "label": "AVS Private Cloud Name",
                                    "defaultValue": "",
                                    "placeholder": "Example: Prefix-SDDC",
                                    "toolTip": "Name of your AVS Private Cloud resource, e.g. AVS-SDDC",
                                    "constraints": {
                                        "required": true,
                                        "regex": "",
                                        "validationMessage": "Provide a name for your Private Cloud"
                                    }
                                }
                            ]
                        },
                        {
                            "name": "NetworkNaming",
                            "type": "Microsoft.Common.Section",
                            "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('azureNetwork').VNetExists, false))]",
                            "label": "Azure Connectivity Naming",
                            "elements": [
                                {
                                    "name": "CustomNetworkResourceGroup",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('azureNetwork').VNetExists, false))]",
                                    "label": "New Virtual Network Resource Group Name",
                                    "defaultValue": "",
                                    "placeholder": "Example: Prefix-Network",
                                    "toolTip": "Name of the new virtual network resource group",
                                    "constraints": {
                                        "required": true,
                                        "regex": "",
                                        "validationMessage": "Provide a name for your new virtual network"
                                    }
                                },
                                {
                                    "name": "CustomNetworkName",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('azureNetwork').VNetExists, false))]",
                                    "label": "New Virtual Network Name",
                                    "defaultValue": "",
                                    "placeholder": "Example: Prefix-vnet",
                                    "toolTip": "Name of the new virtual network",
                                    "constraints": {
                                        "required": true,
                                        "regex": "",
                                        "validationMessage": "Provide a name for your New Virtual Network"
                                    }
                                }
                            ]
                        },
                        {
                            "name": "MonitoringNaming",
                            "type": "Microsoft.Common.Section",
                            "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('Monitoring').DeployMonitoring, true))]",
                            "label": "Monitoring Naming",
                            "elements": [
                                {
                                    "name": "MonitoringResourceGroup",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('Monitoring').DeployMonitoring, true))]",
                                    "label": "Monitoring Resource Group Name",
                                    "defaultValue": "",
                                    "placeholder": "Example: Prefix-Operational",
                                    "toolTip": "Name of the new Monitoring resource group",
                                    "constraints": {
                                        "required": true,
                                        "regex": "",
                                        "validationMessage": ""
                                    }
                                }
                            ]
                        },
                        {
                            "name": "LoggingNaming",
                            "type": "Microsoft.Common.Section",
                            "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), or(equals(steps('Diagnostics').Workspace.DeployWorkspace, true),equals(steps('Diagnostics').StorageAccount.DeployStorageAccount, true)))]",
                            "label": "Logging Naming",
                            "elements": [
                                {
                                    "name": "LoggingResourceGroup",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), or(equals(steps('Diagnostics').Workspace.DeployWorkspace, true),equals(steps('Diagnostics').StorageAccount.DeployStorageAccount, true)))]",
                                    "label": "Logging Resource Group Name",
                                    "defaultValue": "",
                                    "placeholder": "Example: Prefix-Operational",
                                    "toolTip": "Name of the new Logging resource group",
                                    "constraints": {
                                        "required": true,
                                        "regex": "",
                                        "validationMessage": ""
                                    }
                                },
                                {
                                    "name": "CustomWorkspaceName",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('Diagnostics').Workspace.DeployWorkspace, true))]",
                                    "label": "New Workspace Name",
                                    "defaultValue": "",
                                    "placeholder": "Example: Prefix-log",
                                    "toolTip": "Name of the new Log Analytics Workspace",
                                    "constraints": {
                                        "required": true,
                                        "regex": "",
                                        "validationMessage": ""
                                    }
                                },
                                {
                                    "name": "CustomStorageAccountName",
                                    "type": "Microsoft.Common.TextBox",
                                    "visible": "[and(equals(steps('ResourceNaming').CustomNaming, true), equals(steps('Diagnostics').StorageAccount.DeployStorageAccount, true))]",
                                    "label": "New Storage Account Name",
                                    "defaultValue": "",
                                    "placeholder": "",
                                    "toolTip": "Name of the new Storage account",
                                    "constraints": {
                                        "required": true,
                                        "regex": "^[a-z0-9]{3,24}$",
                                        "validationMessage": "The name must be unique across all existing storage account names in Azure. It must be 3 to 24 characters long, and can contain only lowercase letters and numbers."
                                    }
                                }
                            ]
                        }         
                    ]
                }
            ]
        },
        "outputs": {
            "parameters": {
                "Location": "[steps('basics').avsDeploymentScope.location.name]",
                "DeployPrivateCloud": "[steps('PrivateCloud').DeployPrivateCloud]",
                "PrivateCloudAddressSpace": "[steps('PrivateCloud').avsPrivateCloudSettings.avsAddressSpace]",
                "PrivateCloudSKU": "[steps('PrivateCloud').avsPrivateCloudSettings.avsSkuType]",
                "PrivateCloudHostCount": "[steps('PrivateCloud').avsPrivateCloudSettings.avsHostCount]",
                "ExistingPrivateCloudName": "[if(equals(steps('PrivateCloud').DeployPrivateCloud, false), steps('PrivateCloud').existingAVSPrivateCloudSettings.existingAVSSelector.name, 'none')]",
                "ExistingPrivateCloudResourceId": "[if(equals(steps('PrivateCloud').DeployPrivateCloud, false), steps('PrivateCloud').existingAVSPrivateCloudSettings.existingAVSSelector.id, 'none')]",
                "VNetExists": "[steps('azureNetwork').VNetExists]",
                "DeployNetworking": "[steps('azureNetwork').DeployNetworking]",
                "ExistingNetworkResourceId": "[if(equals(steps('azureNetwork').VNetExists, true), steps('azureNetwork').VnetSelectorId.id, '/subscriptions/1caa5ab4-523f-4851-952b-1b689c48fae9/resourceGroups/TESTRG/providers/Microsoft.Network/virtualNetworks/TESTVNET')]",
                "ExistingGatewayName": "[steps('azureNetwork').virtualNetworkGateway]",
                "NewVNetAddressSpace": "[if(equals(steps('azureNetwork').VNetExists, false), steps('azureNetwork').vNetAddressSpace, 'none')]",
                "NewVnetNewGatewaySubnetAddressPrefix": "[if(equals(steps('azureNetwork').VNetExists, false), steps('azureNetwork').GatewaySubnet, 'none')]",
                "BastionSubnet": "[steps('azureNetwork').BastionSubnet]",
                "JumpboxSubnet": "[steps('azureNetwork').JumpboxSubnet]",
                "DeployJumpbox": "[steps('azureNetwork').createJumpbox]",
                "JumpboxSku": "[steps('azureNetwork').vmSkuSelector]",
                "JumpboxUsername": "[steps('azureNetwork').jumpboxCredentials.jumpboxLocalUserName]",
                "JumpboxPassword": "[steps('azureNetwork').jumpboxCredentials.JumpboxPassword.password]",
                "operatingSystemSKU": "[steps('azureNetwork').operatingSystemSKU]",
                "BootstrapJumpboxVM": "[steps('azureNetwork').BootstrapJumpboxVM]",
                "DeployMonitoring": "[steps('Monitoring').DeployMonitoring]",
                "DeployWorkbook": "[steps('Monitoring').AVSWorkbook.DeployAVSWorkbook]",
                "DeployDashboard": "[steps('Monitoring').AVSDashboard.DeployDashboard]",
                "DeployServiceHealth": "[steps('Monitoring').AVSDashboard.DeployServiceHealth]",
                "DeployMetricAlerts": "[steps('Monitoring').AVSDashboard.DeployAVSAlerts]",
                "AlertEmails": "[steps('Monitoring').MonitoringInputs.ActionGroupEmails]",
                "CPUUsageThreshold": "[if(equals(steps('Monitoring').DeployMonitoring, true), steps('Monitoring').MonitoringInputs.cpuUsageThreshold, '0')]",
                "MemoryUsageThreshold": "[if(equals(steps('Monitoring').DeployMonitoring, true), steps('Monitoring').MonitoringInputs.memoryUsageThreshold, '0')]",
                "StorageUsageThreshold": "[if(equals(steps('Monitoring').DeployMonitoring, true), steps('Monitoring').MonitoringInputs.storageUsageThreshold, '0')]",
                "DeployDiagnostics": "[steps('Diagnostics').DeployDiagnostics]",
                "EnableAVSLogsWorkspaceSetting": "[steps('Diagnostics').Workspace.AVSLogCollection]",
                "DeployActivityLogDiagnostics": "[steps('Diagnostics').Workspace.ActivityLogCollection]",
                "EnableAVSLogsStorageSetting": "[steps('Diagnostics').StorageAccount.StorageLogCollection]",
                "DeployWorkspace": "[steps('Diagnostics').Workspace.DeployWorkspace]",
                "NewWorkspaceName": "[steps('ResourceNaming').LoggingNaming.CustomWorkspaceName]",
                "ExistingWorkspaceId": "[steps('Diagnostics').Workspace.existingWorkspaceSelector.id]",
                "ExistingStorageAccountId": "[steps('Diagnostics').StorageAccount.existingStorageAccountSelector.id]",
                "DeployStorageAccount": "[steps('Diagnostics').StorageAccount.DeployStorageAccount]",
                "NewStorageAccountName": "[steps('ResourceNaming').LoggingNaming.CustomStorageAccountName]",
                "StorageRetentionDays": "[steps('Diagnostics').StorageAccount.storageRetention]",
                "DeployHCX": "[steps('Addons').deployHCX]",
                "DeploySRM": "[steps('Addons').deploySRM]",
                "SRMLicenseKey": "[steps('Addons').srmLicenseKey]",
                "VRServerCount": "[steps('Addons').srmVRCount]",
                "avsUseCustomNaming": "[steps('ResourceNaming').CustomNaming]",
                "Prefix": "[steps('ResourceNaming').avsDeploymentPrefix]",
                "PrivateCloudResourceGroupName": "[steps('ResourceNaming').PrivateCloudNaming.AVSResourceGroup]",
                "PrivateCloudName": "[steps('ResourceNaming').PrivateCloudNaming.AVSName]",
                "NewNetworkResourceGroupName": "[steps('ResourceNaming').NetworkNaming.CustomNetworkResourceGroup]",
                "NewNetworkName": "[steps('ResourceNaming').NetworkNaming.CustomNetworkName]",
                "MonitoringResourceGroupName": "[steps('ResourceNaming').MonitoringNaming.MonitoringResourceGroup]",
                "LoggingResourceGroupName": "[steps('ResourceNaming').LoggingNaming.LoggingResourceGroup]",
                "TelemetryOptOut": "false"
            },
            "kind": "Subscription",
            "location": "[steps('basics').avsDeploymentScope.location.name]",
            "subscriptionId": "[steps('basics').avsDeploymentScope.subscription.id]"
        }
    }
}